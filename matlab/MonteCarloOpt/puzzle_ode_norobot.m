function dx = puzzle_ode_norobot(tS, xS, rates)
%PUZZLECASE_ODE Definition of the derivatives of the Puzzle Test Case
%   system

k1 = rates(1);
k2 = rates(2);
k3 = rates(3);
k4 = rates(4);
k5 = rates(5);
k6 = rates(6);
k7 = rates(7);
k8 = rates(8);
k9 = rates(9);
k10 = rates(10);
k11 = rates(11);
k12 = rates(12);

% Take care of null/negative populations
xS(xS<0) = 0;

KS = [  -k1,   k2,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0; ...
        k1,  -k2,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0; ...
        0,    0,  -k3,   k4,    0,    0,    0,    0,    0,    0,    0,    0; ...
        0,    0,   k3,  -k4,    0,    0,    0,    0,    0,    0,    0,    0; ...
        0,    0,    0,    0,  -k5,   k6,    0,    0,    0,    0,    0,    0; ...
        0,    0,    0,    0,   k5,  -k6,    0,    0,    0,    0,    0,    0; ...
        0,    0,    0,    0,    0,    0,  -k7,   k8,    0,    0,    0,    0; ...
        0,    0,    0,    0,    0,    0,   k7,  -k8,    0,    0,    0,    0; ...
        0,    0,    0,    0,    0,    0,    0,    0,  -k9,  k10,    0,    0; ...
        0,    0,    0,    0,    0,    0,    0,    0,   k9, -k10,    0,    0; ...
        0,    0,    0,    0,    0,    0,    0,    0,    0,    0, -k11,  k12; ...
        0,    0,    0,    0,    0,    0,    0,    0,    0,    0,  k11, -k12];
    
YS = [1     0     0     0     0     0     0     0     0     0     0     0; ...
     1     0     0     0     1     0     0     0     1     0     0     0; ...
     0     0     1     0     0     0     0     0     0     0     0     0; ...
     0     0     1     0     0     0     0     0     0     0     0     0; ...
     0     1     0     0     0     0     1     0     1     0     0     0; ...
     0     0     0     1     0     0     1     0     0     0     1     0; ...
     0     0     0     0     1     0     0     1     0     0     0     0; ...
     0     0     0     0     0     0     0     0     0     1     1     0; ...
     0     0     0     0     0     1     0     0     0     0     0     0; ...
     0     0     0     0     0     0     0     0     0     0     0     1];

yS = [xS(1)*xS(2); xS(5); xS(3)*xS(4); xS(6); xS(2)*xS(7); xS(9); xS(5)*xS(6); xS(7); ...
     xS(2)*xS(5); xS(8); xS(6)*xS(8); xS(10)];  % x(9) = xf1; x(10) = xf2

dx = YS*KS*yS;
              

