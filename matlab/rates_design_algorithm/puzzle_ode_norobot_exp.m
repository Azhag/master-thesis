function dx = puzzle_ode_norobot_exp(t, x, rates)
%PUZZLECASE_ODE Definition of the derivatives of the Puzzle Test Case
%   system

k1 = rates(1);
k2 = rates(2);
k3 = rates(3);
k4 = rates(4);
k5 = rates(5);
k6 = rates(6);
k7 = rates(7);
k8 = rates(8);
k9 = rates(9);
k10 = rates(10);
k11 = rates(11);
k12 = rates(12);
k13 = rates(13);
k14 = rates(14);
k15 = rates(15);
k16 = rates(16);
k17 = rates(17);
k18 = rates(18);
k19 = rates(19);
k20 = rates(20);

% Take care of null/negative populations
x(x<0) = 0;

K = [  -k1   k2,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0 0 0 0 0 0 0; ...
        k1  -k2,    0,    0,    0,    0,    0,    0,    0,    0,    0,    0 0 0 0 0 0 0; ...
        0,    0,  -k3,   k4,    0,    0,    0,    0,    0,    0,    0,    0  0 0 0 0 0 0; ...
        0,    0,   k3,  -k4,    0,    0,    0,    0,    0,    0,    0,    0 0 0 0 0 0 0; ...
        0,    0,    0,    0,  -k5,   k6,    0,    0,    0,    0,    0,    0 0 0 0 0 0 0; ...
        0,    0,    0,    0,   k5,  -k6,    0,    0,    0,    0,    0,    0 0 0 0 0 0 0; ...
        0,    0,    0,    0,    0,    0,  -k7,   k8,    0,    0,    0,    0 0 0 0 0 0 0; ...
        0,    0,    0,    0,    0,    0,   k7,  -k8-k16,    0,    0,    0,    0 0 0 k15 0 0 0; ...
        0,    0,    0,    0,    0,    0,    0,    0,  -k9,  k10,    0,    0 0 0 0 0 0 0; ...
        0,    0,    0,    0,    0,    0,    0,    0,   k9, -k10,    0,    0 0 0 0 0 0 0; ...
        0    0,    0,    0,    0,    0,    0,    0,    0,    0, -k11,  k12 0 0 0 0 0 0; ...
        0    0,    0,    0,    0,    0,    0,    0,    0,    0,  k11, -k12-k20 0 0 0 0 0 k19; ...
        0 0 0 0 0 0 0 0 0 0 0 0 -k13 k14 0 0 0 0; ...
        0 0 0 0 0 0 0 0 0 0 0 0 k13 -k14 0 0 0 0; ...
        0 0 0 0 0 0 0 k16 0 0 0 0 0 0 -k15 0 0 0; ...
        0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 -k17 k18 0; ...
        0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 k17 -k18 0; ...
        0 0 0 0 0 0 0 0 0 0 0 k20 0 0 0 0 0 -k19];

Y = [1     0     0     0     0     0     0     0     0     0     0     0; ...
     1     0     0     0     1     0     0     0     1     0     0     0; ...
     0     0     1     0     0     0     0     0     0     0     0     0; ...
     0     0     1     0     0     0     0     0     0     0     0     0; ...
     0     1     0     0     0     0     1     0     1     0     0     0; ...
     0     0     0     1     0     0     1     0     0     0     1     0; ...
     0     0     0     0     1     0     0     1     0     0     0     0; ...
     0     0     0     0     0     0     0     0     0     1     1     0; ...
     0     0     0     0     0     1     0     0     0     0     0     0; ...
     0     0     0     0     0     0     0     0     0     0     0     1; ...
     0     0     0     0     0     0     0     0     0     0     0     0; ...
     0     0     0     0     0     0     0     0     0     0     0     0];
 
Y(1:12,13:18) = [[0 0 1 0 1 0 0 0 0 0 0 0]' [zeros(1,10) 1 0]' [0 0 0 1 0 0 0 0 0 0 1 0]'...
              [0 0 1 0 0 0 0 1 0 0 0 0]' [zeros(1,11) 1]'...
              [0 0 0 1 0 0 0 0 0 0 0 1]'];

y = [x(1)*x(2); x(5); x(3)*x(4); x(6); x(2)*x(7); x(9); x(5)*x(6); x(7); x(2)*x(5); x(8); x(6)*x(8); x(10);
     x(3)*x(5); x(11); x(4)*x(11); x(3)*x(8); x(12); x(4)*x(12)];
          
dx = Y*K*y;
              

